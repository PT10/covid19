import { Component, OnInit } from '@angular/core';
import { EChartOption } from 'echarts';
import { BaseCases } from '../baseCases';
import * as echarts from 'echarts/lib/echarts';

import { worldGeoJson } from '../world-json-provider.service';

@Component({
  selector: 'app-world-death-cases',
  templateUrl: './world-death-cases.component.html',
  styleUrls: ['./world-death-cases.component.css']
})
export class WorldDeathCasesComponent extends BaseCases implements OnInit {

  relocatedCounties;
  selectedDateIndex: number;
  inProgress = false;

  chartTitle = 'Covid 19 daily world death trends';

  constructor() {
    super();

    this.seriesData = [
      {"Country/Region": "Afghanistan", "Province/State": NaN, "actualDelta": 4, "forecastDelta": 0, "actual": 68, "forecast": 64}, {"Country/Region": "Albania", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 31, "forecast": 31}, {"Country/Region": "Algeria", "Province/State": NaN, "actualDelta": 3, "forecastDelta": 5, "actual": 453, "forecast": 455}, {"Country/Region": "Andorra", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 43, "forecast": 42}, {"Country/Region": "Angola", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "Antigua and Barbuda", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "Argentina", "Province/State": NaN, "actualDelta": 7, "forecastDelta": 3, "actual": 225, "forecast": 221}, {"Country/Region": "Armenia", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 33, "forecast": 32}, {"Country/Region": "Australia", "Province/State": "Australian Capital Territory", "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "Australia", "Province/State": "New South Wales", "actualDelta": 0, "forecastDelta": 0, "actual": 41, "forecast": 41}, {"Country/Region": "Australia", "Province/State": "Northern Territory", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Australia", "Province/State": "Queensland", "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "Australia", "Province/State": "South Australia", "actualDelta": 0, "forecastDelta": 0, "actual": 4, "forecast": 4}, {"Country/Region": "Australia", "Province/State": "Tasmania", "actualDelta": 0, "forecastDelta": 0, "actual": 13, "forecast": 13}, {"Country/Region": "Australia", "Province/State": "Victoria", "actualDelta": 0, "forecastDelta": 0, "actual": 18, "forecast": 18}, {"Country/Region": "Australia", "Province/State": "Western Australia", "actualDelta": 0, "forecastDelta": 0, "actual": 8, "forecast": 8}, {"Country/Region": "Austria", "Province/State": NaN, "actualDelta": 5, "forecastDelta": 4, "actual": 589, "forecast": 588}, {"Country/Region": "Azerbaijan", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 25, "forecast": 24}, {"Country/Region": "Bahamas", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 11, "forecast": 11}, {"Country/Region": "Bahrain", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 8, "forecast": 8}, {"Country/Region": "Bangladesh", "Province/State": NaN, "actualDelta": 2, "forecastDelta": 5, "actual": 170, "forecast": 173}, {"Country/Region": "Barbados", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 7, "forecast": 7}, {"Country/Region": "Belarus", "Province/State": NaN, "actualDelta": 4, "forecastDelta": 3, "actual": 93, "forecast": 92}, {"Country/Region": "Belgium", "Province/State": NaN, "actualDelta": 109, "forecastDelta": 92, "actual": 7703, "forecast": 7686}, {"Country/Region": "Benin", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 2, "forecast": 1}, {"Country/Region": "Bhutan", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Bolivia", "Province/State": NaN, "actualDelta": 7, "forecastDelta": 0, "actual": 66, "forecast": 59}, {"Country/Region": "Bosnia and Herzegovina", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 1, "actual": 70, "forecast": 70}, {"Country/Region": "Brazil", "Province/State": NaN, "actualDelta": 406, "forecastDelta": 165, "actual": 6412, "forecast": 6171}, {"Country/Region": "Brunei", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Bulgaria", "Province/State": NaN, "actualDelta": 2, "forecastDelta": 1, "actual": 68, "forecast": 67}, {"Country/Region": "Burkina Faso", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 44, "forecast": 43}, {"Country/Region": "Cabo Verde", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Cambodia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Cameroon", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 61, "forecast": 61}, {"Country/Region": "Canada", "Province/State": "Alberta", "actualDelta": 2, "forecastDelta": 2, "actual": 92, "forecast": 92}, {"Country/Region": "Canada", "Province/State": "British Columbia", "actualDelta": 1, "forecastDelta": 1, "actual": 112, "forecast": 112}, {"Country/Region": "Canada", "Province/State": "Grand Princess", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Canada", "Province/State": "Manitoba", "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "Canada", "Province/State": "New Brunswick", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Canada", "Province/State": "Newfoundland and Labrador", "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "Canada", "Province/State": "Nova Scotia", "actualDelta": 1, "forecastDelta": 0, "actual": 29, "forecast": 28}, {"Country/Region": "Canada", "Province/State": "Ontario", "actualDelta": 60, "forecastDelta": 44, "actual": 1265, "forecast": 1249}, {"Country/Region": "Canada", "Province/State": "Prince Edward Island", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Canada", "Province/State": "Quebec", "actualDelta": 163, "forecastDelta": 71, "actual": 2022, "forecast": 1930}, {"Country/Region": "Canada", "Province/State": "Saskatchewan", "actualDelta": 0, "forecastDelta": 0, "actual": 7, "forecast": 7}, {"Country/Region": "Central African Republic", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Chad", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 5, "forecast": 5}, {"Country/Region": "Chile", "Province/State": NaN, "actualDelta": 7, "forecastDelta": 8, "actual": 234, "forecast": 235}, {"Country/Region": "China", "Province/State": "Anhui", "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "China", "Province/State": "Beijing", "actualDelta": 0, "forecastDelta": 0, "actual": 9, "forecast": 9}, {"Country/Region": "China", "Province/State": "Chongqing", "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "China", "Province/State": "Fujian", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "China", "Province/State": "Gansu", "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "China", "Province/State": "Guangdong", "actualDelta": 0, "forecastDelta": 0, "actual": 8, "forecast": 8}, {"Country/Region": "China", "Province/State": "Guangxi", "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "China", "Province/State": "Guizhou", "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "China", "Province/State": "Hainan", "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "China", "Province/State": "Hebei", "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "China", "Province/State": "Heilongjiang", "actualDelta": 0, "forecastDelta": 0, "actual": 13, "forecast": 13}, {"Country/Region": "China", "Province/State": "Henan", "actualDelta": 0, "forecastDelta": 0, "actual": 22, "forecast": 22}, {"Country/Region": "China", "Province/State": "Hong Kong", "actualDelta": 0, "forecastDelta": 0, "actual": 4, "forecast": 4}, {"Country/Region": "China", "Province/State": "Hubei", "actualDelta": 0, "forecastDelta": 2, "actual": 4512, "forecast": 4514}, {"Country/Region": "China", "Province/State": "Hunan", "actualDelta": 0, "forecastDelta": 0, "actual": 4, "forecast": 4}, {"Country/Region": "China", "Province/State": "Inner Mongolia", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "China", "Province/State": "Jiangsu", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "China", "Province/State": "Jiangxi", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "China", "Province/State": "Jilin", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "China", "Province/State": "Liaoning", "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "China", "Province/State": "Macau", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "China", "Province/State": "Ningxia", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "China", "Province/State": "Qinghai", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "China", "Province/State": "Shaanxi", "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "China", "Province/State": "Shandong", "actualDelta": 0, "forecastDelta": 0, "actual": 7, "forecast": 7}, {"Country/Region": "China", "Province/State": "Shanghai", "actualDelta": 0, "forecastDelta": 0, "actual": 7, "forecast": 7}, {"Country/Region": "China", "Province/State": "Shanxi", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "China", "Province/State": "Sichuan", "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "China", "Province/State": "Tianjin", "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "China", "Province/State": "Tibet", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "China", "Province/State": "Xinjiang", "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "China", "Province/State": "Yunnan", "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "China", "Province/State": "Zhejiang", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Colombia", "Province/State": NaN, "actualDelta": 21, "forecastDelta": 10, "actual": 314, "forecast": 303}, {"Country/Region": "Congo (Brazzaville)", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 9, "forecast": 9}, {"Country/Region": "Congo (Kinshasa)", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 32, "forecast": 31}, {"Country/Region": "Costa Rica", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "Cote d'Ivoire", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 15, "forecast": 14}, {"Country/Region": "Croatia", "Province/State": NaN, "actualDelta": 6, "forecastDelta": 1, "actual": 75, "forecast": 70}, {"Country/Region": "Diamond Princess", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 13, "forecast": 13}, {"Country/Region": "Cuba", "Province/State": NaN, "actualDelta": 3, "forecastDelta": 1, "actual": 64, "forecast": 62}, {"Country/Region": "Cyprus", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 15, "forecast": 15}, {"Country/Region": "Czechia", "Province/State": NaN, "actualDelta": 4, "forecastDelta": 4, "actual": 240, "forecast": 240}, {"Country/Region": "Denmark", "Province/State": "Faroe Islands", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Denmark", "Province/State": "Greenland", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Denmark", "Province/State": NaN, "actualDelta": 8, "forecastDelta": 9, "actual": 460, "forecast": 461}, {"Country/Region": "Djibouti", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "Dominican Republic", "Province/State": NaN, "actualDelta": 12, "forecastDelta": 7, "actual": 313, "forecast": 308}, {"Country/Region": "Ecuador", "Province/State": NaN, "actualDelta": 163, "forecastDelta": 16, "actual": 1063, "forecast": 916}, {"Country/Region": "Egypt", "Province/State": NaN, "actualDelta": 14, "forecastDelta": 11, "actual": 406, "forecast": 403}, {"Country/Region": "El Salvador", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 10, "forecast": 10}, {"Country/Region": "Equatorial Guinea", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Eritrea", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Estonia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 52, "forecast": 52}, {"Country/Region": "Eswatini", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Ethiopia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "Fiji", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Finland", "Province/State": NaN, "actualDelta": 7, "forecastDelta": 5, "actual": 218, "forecast": 216}, {"Country/Region": "France", "Province/State": "French Guiana", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "France", "Province/State": "French Polynesia", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "France", "Province/State": "Guadeloupe", "actualDelta": 0, "forecastDelta": 0, "actual": 12, "forecast": 12}, {"Country/Region": "France", "Province/State": "Mayotte", "actualDelta": 0, "forecastDelta": 0, "actual": 4, "forecast": 4}, {"Country/Region": "France", "Province/State": "New Caledonia", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "France", "Province/State": "Reunion", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "France", "Province/State": "Saint Barthelemy", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "France", "Province/State": "St Martin", "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "France", "Province/State": "Martinique", "actualDelta": 0, "forecastDelta": 0, "actual": 14, "forecast": 14}, {"Country/Region": "France", "Province/State": NaN, "actualDelta": 218, "forecastDelta": 282, "actual": 24594, "forecast": 24658}, {"Country/Region": "Gabon", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "Gambia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Georgia", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 7, "forecast": 6}, {"Country/Region": "Germany", "Province/State": NaN, "actualDelta": 113, "forecastDelta": 155, "actual": 6736, "forecast": 6778}, {"Country/Region": "Ghana", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 17, "forecast": 17}, {"Country/Region": "Greece", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 1, "actual": 140, "forecast": 141}, {"Country/Region": "Guatemala", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 16, "forecast": 16}, {"Country/Region": "Guinea", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 7, "forecast": 7}, {"Country/Region": "Guyana", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 9, "forecast": 9}, {"Country/Region": "Haiti", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 8, "forecast": 8}, {"Country/Region": "Holy See", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Honduras", "Province/State": NaN, "actualDelta": 4, "forecastDelta": 0, "actual": 75, "forecast": 71}, {"Country/Region": "Hungary", "Province/State": NaN, "actualDelta": 11, "forecastDelta": 10, "actual": 323, "forecast": 322}, {"Country/Region": "Iceland", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 10, "forecast": 10}, {"Country/Region": "India", "Province/State": NaN, "actualDelta": 69, "forecastDelta": 40, "actual": 1223, "forecast": 1194}, {"Country/Region": "Indonesia", "Province/State": NaN, "actualDelta": 8, "forecastDelta": 7, "actual": 800, "forecast": 799}, {"Country/Region": "Iran", "Province/State": NaN, "actualDelta": 63, "forecastDelta": 80, "actual": 6091, "forecast": 6108}, {"Country/Region": "Iraq", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 1, "actual": 94, "forecast": 94}, {"Country/Region": "Ireland", "Province/State": NaN, "actualDelta": 33, "forecastDelta": 37, "actual": 1265, "forecast": 1269}, {"Country/Region": "Israel", "Province/State": NaN, "actualDelta": 3, "forecastDelta": 6, "actual": 225, "forecast": 228}, {"Country/Region": "Italy", "Province/State": NaN, "actualDelta": 269, "forecastDelta": 312, "actual": 28236, "forecast": 28279}, {"Country/Region": "Jamaica", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 8, "forecast": 8}, {"Country/Region": "Japan", "Province/State": NaN, "actualDelta": 25, "forecastDelta": 12, "actual": 455, "forecast": 442}, {"Country/Region": "Jordan", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 8, "forecast": 8}, {"Country/Region": "Kazakhstan", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 25, "forecast": 25}, {"Country/Region": "Kenya", "Province/State": NaN, "actualDelta": 4, "forecastDelta": 0, "actual": 21, "forecast": 17}, {"Country/Region": "Korea, South", "Province/State": NaN, "actualDelta": 2, "forecastDelta": 1, "actual": 250, "forecast": 249}, {"Country/Region": "Kuwait", "Province/State": NaN, "actualDelta": 4, "forecastDelta": 0, "actual": 30, "forecast": 26}, {"Country/Region": "Kyrgyzstan", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 8, "forecast": 8}, {"Country/Region": "Latvia", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 16, "forecast": 15}, {"Country/Region": "Lebanon", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 24, "forecast": 24}, {"Country/Region": "Liberia", "Province/State": NaN, "actualDelta": 2, "forecastDelta": 0, "actual": 18, "forecast": 16}, {"Country/Region": "Liechtenstein", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Lithuania", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 45, "forecast": 45}, {"Country/Region": "Luxembourg", "Province/State": NaN, "actualDelta": 2, "forecastDelta": 0, "actual": 92, "forecast": 90}, {"Country/Region": "Madagascar", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Malaysia", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 1, "actual": 103, "forecast": 103}, {"Country/Region": "Maldives", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Malta", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 4, "forecast": 4}, {"Country/Region": "Mauritania", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Mauritius", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 10, "forecast": 10}, {"Country/Region": "Mexico", "Province/State": NaN, "actualDelta": 113, "forecastDelta": 55, "actual": 1972, "forecast": 1914}, {"Country/Region": "Moldova", "Province/State": NaN, "actualDelta": 6, "forecastDelta": 4, "actual": 122, "forecast": 120}, {"Country/Region": "Monaco", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 4, "forecast": 4}, {"Country/Region": "Mongolia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Montenegro", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 7, "forecast": 7}, {"Country/Region": "Morocco", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 2, "actual": 171, "forecast": 172}, {"Country/Region": "Namibia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Nepal", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Netherlands", "Province/State": "Aruba", "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "Netherlands", "Province/State": "Curacao", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Netherlands", "Province/State": "Sint Maarten", "actualDelta": 0, "forecastDelta": 0, "actual": 13, "forecast": 13}, {"Country/Region": "Netherlands", "Province/State": NaN, "actualDelta": 98, "forecastDelta": 83, "actual": 4893, "forecast": 4878}, {"Country/Region": "New Zealand", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 20, "forecast": 19}, {"Country/Region": "Nicaragua", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "Niger", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 33, "forecast": 32}, {"Country/Region": "Nigeria", "Province/State": NaN, "actualDelta": 10, "forecastDelta": 0, "actual": 68, "forecast": 58}, {"Country/Region": "North Macedonia", "Province/State": NaN, "actualDelta": 4, "forecastDelta": 2, "actual": 81, "forecast": 79}, {"Country/Region": "Norway", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 3, "actual": 210, "forecast": 213}, {"Country/Region": "Oman", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 11, "forecast": 11}, {"Country/Region": "Pakistan", "Province/State": NaN, "actualDelta": 32, "forecastDelta": 11, "actual": 417, "forecast": 396}, {"Country/Region": "Panama", "Province/State": NaN, "actualDelta": 4, "forecastDelta": 5, "actual": 192, "forecast": 193}, {"Country/Region": "Papua New Guinea", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Paraguay", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 10, "forecast": 10}, {"Country/Region": "Peru", "Province/State": NaN, "actualDelta": 73, "forecastDelta": 33, "actual": 1124, "forecast": 1084}, {"Country/Region": "Philippines", "Province/State": NaN, "actualDelta": 11, "forecastDelta": 9, "actual": 579, "forecast": 577}, {"Country/Region": "Poland", "Province/State": NaN, "actualDelta": 7, "forecastDelta": 19, "actual": 651, "forecast": 663}, {"Country/Region": "Portugal", "Province/State": NaN, "actualDelta": 18, "forecastDelta": 16, "actual": 1007, "forecast": 1005}, {"Country/Region": "Qatar", "Province/State": NaN, "actualDelta": 2, "forecastDelta": 0, "actual": 12, "forecast": 10}, {"Country/Region": "Romania", "Province/State": NaN, "actualDelta": 27, "forecastDelta": 21, "actual": 744, "forecast": 738}, {"Country/Region": "Russia", "Province/State": NaN, "actualDelta": 96, "forecastDelta": 40, "actual": 1169, "forecast": 1113}, {"Country/Region": "Rwanda", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Saint Lucia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Saint Vincent and the Grenadines", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "San Marino", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 41, "forecast": 41}, {"Country/Region": "Saudi Arabia", "Province/State": NaN, "actualDelta": 7, "forecastDelta": 4, "actual": 169, "forecast": 166}, {"Country/Region": "Senegal", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 9, "forecast": 9}, {"Country/Region": "Serbia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 5, "actual": 179, "forecast": 184}, {"Country/Region": "Seychelles", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Singapore", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 16, "forecast": 15}, {"Country/Region": "Slovakia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 23, "forecast": 23}, {"Country/Region": "Slovenia", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 1, "actual": 92, "forecast": 92}, {"Country/Region": "Somalia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 28, "forecast": 28}, {"Country/Region": "South Africa", "Province/State": NaN, "actualDelta": 13, "forecastDelta": 0, "actual": 116, "forecast": 103}, {"Country/Region": "Spain", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 273, "actual": 24543, "forecast": 24816}, {"Country/Region": "Sri Lanka", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 7, "forecast": 7}, {"Country/Region": "Sudan", "Province/State": NaN, "actualDelta": 5, "forecastDelta": 0, "actual": 36, "forecast": 31}, {"Country/Region": "Suriname", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Sweden", "Province/State": NaN, "actualDelta": 67, "forecastDelta": 84, "actual": 2653, "forecast": 2670}, {"Country/Region": "Switzerland", "Province/State": NaN, "actualDelta": 17, "forecastDelta": 24, "actual": 1754, "forecast": 1761}, {"Country/Region": "Taiwan*", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "Tanzania", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 16, "forecast": 16}, {"Country/Region": "Thailand", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 54, "forecast": 54}, {"Country/Region": "Togo", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 9, "forecast": 9}, {"Country/Region": "Trinidad and Tobago", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 8, "forecast": 8}, {"Country/Region": "Tunisia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 41, "forecast": 41}, {"Country/Region": "Turkey", "Province/State": NaN, "actualDelta": 84, "forecastDelta": 93, "actual": 3258, "forecast": 3267}, {"Country/Region": "Uganda", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Ukraine", "Province/State": NaN, "actualDelta": 11, "forecastDelta": 8, "actual": 272, "forecast": 269}, {"Country/Region": "United Arab Emirates", "Province/State": NaN, "actualDelta": 6, "forecastDelta": 3, "actual": 111, "forecast": 108}, {"Country/Region": "United Kingdom", "Province/State": "Bermuda", "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "United Kingdom", "Province/State": "Cayman Islands", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "United Kingdom", "Province/State": "Channel Islands", "actualDelta": 1, "forecastDelta": 0, "actual": 41, "forecast": 40}, {"Country/Region": "United Kingdom", "Province/State": "Gibraltar", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "United Kingdom", "Province/State": "Isle of Man", "actualDelta": 1, "forecastDelta": 0, "actual": 22, "forecast": 21}, {"Country/Region": "United Kingdom", "Province/State": "Montserrat", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "United Kingdom", "Province/State": NaN, "actualDelta": 739, "forecastDelta": 675, "actual": 27510, "forecast": 27446}, {"Country/Region": "Uruguay", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 17, "forecast": 17}, {"Country/Region": "US", "Province/State": NaN, "actualDelta": 1947, "forecastDelta": 2032, "actual": 64943, "forecast": 65028}, {"Country/Region": "Uzbekistan", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 9, "forecast": 9}, {"Country/Region": "Venezuela", "Province/State": NaN, "actualDelta": -6, "forecastDelta": 0, "actual": 10, "forecast": 16}, {"Country/Region": "Vietnam", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Zambia", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "Zimbabwe", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 4, "forecast": 4}, {"Country/Region": "Canada", "Province/State": "Diamond Princess", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Dominica", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Grenada", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Mozambique", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Syria", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "Timor-Leste", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Belize", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "Canada", "Province/State": "Recovered", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Laos", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Libya", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "West Bank and Gaza", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "Guinea-Bissau", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Mali", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 26, "forecast": 26}, {"Country/Region": "Saint Kitts and Nevis", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Canada", "Province/State": "Northwest Territories", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Canada", "Province/State": "Yukon", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Kosovo", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 22, "forecast": 22}, {"Country/Region": "Burma", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 6, "forecast": 6}, {"Country/Region": "United Kingdom", "Province/State": "Anguilla", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "United Kingdom", "Province/State": "British Virgin Islands", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "United Kingdom", "Province/State": "Turks and Caicos Islands", "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "MS Zaandam", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "Botswana", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Burundi", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 1, "forecast": 1}, {"Country/Region": "Sierra Leone", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 7, "forecast": 7}, {"Country/Region": "Netherlands", "Province/State": "Bonaire, Sint Eustatius and Saba", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Malawi", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 3, "forecast": 3}, {"Country/Region": "United Kingdom", "Province/State": "Falkland Islands (Malvinas)", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "France", "Province/State": "Saint Pierre and Miquelon", "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "South Sudan", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Western Sahara", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Sao Tome and Principe", "Province/State": NaN, "actualDelta": 1, "forecastDelta": 0, "actual": 1, "forecast": 0}, {"Country/Region": "Yemen", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 2, "forecast": 2}, {"Country/Region": "Comoros", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}, {"Country/Region": "Tajikistan", "Province/State": NaN, "actualDelta": 0, "forecastDelta": 0, "actual": 0, "forecast": 0}]
  }

  ngOnInit() {
    super.ngOnInit();
    //this.chartHeight = window.document.body.offsetHeight - 100 + 'px';
    echarts.registerMap('world', worldGeoJson); //, this.relocatedCounties
    this.getData();
  }

  getData() {
    this.inProgress = true;
    let actualDeltas = [];

    // Aggregate state wise to country level if any
    const tempSeriesData = [];
    this.seriesData.forEach(data => {
      const series = tempSeriesData.find(s => {
        return s['Country/Region'] === data['Country/Region'] && data['Province/State'] !== NaN
      });
      if (series) {
        series.actualDelta += data.actualDelta;
        series.forecastDelta += data.forecastDelta;
        series.actual += data.actual;
        series.forecast += data.forecast;
      } else {
        tempSeriesData.push(data);
      }
    });
    this.seriesData = tempSeriesData;
    
    this.seriesData.forEach(data => {
      actualDeltas.push(data.actualDelta - data.forecastDelta);
    });

    actualDeltas = actualDeltas.sort((a, b) => {return b - a});
    this.maxVal = actualDeltas[0];
    this.minVal = actualDeltas[actualDeltas.length - 1];
    
    this.processedSeriesData = this.seriesData.map(data => {
      let val;
      if (data.actualDelta === 0 ) {
        val = this.minVal;
      } /*else if (data.forecastDelta === 0) {
        val = 100;
      } */else {
        // val = (data.actualDelta - data.forecastDelta) / data.forecastDelta * 100;
        val = data.actualDelta - data.forecastDelta
      }
      return {name: data['Country/Region'], value: val}
    });

    this.inProgress = false;
  }

  setChartOptions() {
    const me = this;
    this.chartOption.series = [{
          name: 'County covid19 trends',
          type: 'map',
          roam: true,
          map: 'world',
          scaleLimit: {min: 1},
          itemStyle: {
            emphasis: {
              label: {
                show: false
              },
              areaColor: undefined
            }
          },
          data: this.processedSeriesData
        }
      ]
    
    this.chartOption.tooltip = {
        trigger: 'item',
        formatter: function(params) {
          const countyObj = me.seriesData.find(d => {
            return d['Country/Region'] === params['name']
          });

          if (countyObj) {
            return countyObj['Country/Region'] +
            '<br/>' + 'New Deaths: ' + countyObj.actualDelta + ' (Forecasted: ' + countyObj.forecastDelta + ')' +
            '<br/>' + 'Total Deaths: ' + countyObj.actual + ' (Forecasted: ' + countyObj.forecast + ')'
          }
          return params['name'];
      }}
  }

}